\subsection{Parareal Method}

\begin{frame}<1>{Parareal Method}
\begin{columns}
\column{0.7\textwidth}
  \begin{block}{General Formulation \parencite{Lions2001}}
    For the IVP $\dot u = f(u)$ the method reads
    \begin{equation*}
      \left\{
      \begin{aligned}
        U^0_{n+1} &:= G(U^0_n) \\
        U^{k+1}_{n+1} &:= G(U^{k+1}_n) + F(U^k_n) - G(U^k_n)
      \end{aligned}
      \right.
    \end{equation*}
    where $U_0^0 = u(t_0)$.
  \end{block}
  Low-rank formulation (KÃ¶hler, Saak, and Lang 2016):
  % GAMM Annual Meeting
  \begin{align*}
    U^{k+1}_{n+1}
    &= \underbrace{\colorldlt{\cola}}_{G(U^{k+1}_n)}
    + \underbrace{\colorldlt{\colb}}_{F(U^{k}_n)}
    - \underbrace{\colorldlt{\colc}}_{G(U^{k}_n)}
    \\
    &=
    \colorspacing % must be located in respective cell!
    \Bigg[
    \begin{matrix}
      \tallcmat{\cola} &
      \tallcmat{\colb} &
      \tallcmat{\colc}
    \end{matrix}
    \Bigg]
    \begin{bmatrix}
      \smallcmat{\cola} \\
      & \smallcmat{\colb} \\
      && -\smallcmat{\colc}
    \end{bmatrix}
    \begin{bmatrix}
      \widecmat{\cola} \\
      \widecmat{\colb} \\
      \widecmat{\colc}
    \end{bmatrix}
  \end{align*}
\column{0.3\textwidth}
\bigpicture{6}
\end{columns}
\end{frame}

%TODO: replace caption by parareal update formula?
\begin{frame}
  \setbeamertemplate{caption}[numbered]
  \frametitle{Parareal Example}
\begin{columns}
\column{0.65\textwidth}
  \begin{figure}
  \foreach \k in {0,1} {%
  \foreach \n [evaluate={\i=int(1+\n+\k*7)}] in {0,...,6} {%
    \includegraphics<\i>[width=\textwidth]{figures/parareal-anim/step-\k-\n.pdf}%
  }}%
  \includegraphics<15>[width=\textwidth]{figures/parareal-anim/step-2-5.pdf}%
  \includegraphics<16>[width=\textwidth]{figures/parareal-anim/step-2-6.pdf}%
  \includegraphics<17>[width=\textwidth]{figures/parareal-anim/step-3-5.pdf}%
  \includegraphics<18>[width=\textwidth]{figures/parareal-anim/step-3-6.pdf}%
  \renewcommand\thefigure{6.4} % number in thesis
  \caption{Parareal method applied to a linear ODE}
  \end{figure}
\column{0.35\textwidth}
  \input{figures/slide_parareal_anim.tex}
\end{columns}
\end{frame}

\section{Implementation}
\subsection{Runtime Estimation}

\begin{frame}[fragile]
  \setbeamertemplate{caption}[numbered]
  \frametitle{Effect of JIT Compiler Warm-Up}
  \begin{columns}
  \column{0.65\textwidth}
    \begin{figure}
    \includegraphics[width=\textwidth]{figures/fig_impl_warmup1.pdf}%
    \renewcommand\thefigure{7.1} % number in thesis
    \caption{Timeline charts}
    \lstinline!bash fig:impl:warmup.job!
    \end{figure}
  \column{0.35\textwidth}
    \begin{itemize}
      \item
        No warm-up:\\ sequential compilation
        \vspace{2em}
      \item
        Warming-up $G$:\\ parallel compilation
        \vspace{2em}
      \item
        Warming-up $F,G$:\\ no further benefit
        \vspace{2em}
      \pause
      \item[$\leadsto$]
        Always warm-up $G$\\ and $G$ only
    \end{itemize}
    \vspace{2em}
  \end{columns}
\end{frame}

\begin{frame}[t]{Estimating Parareal Runtime}
  \begin{block}{Runtime Model}
  \begin{equation*}
    \hattpar
    := \twarmup
    + \underbrace{
      \strut
      N \cdot (\trampup + t_G)
    }_{\substack{
      \text{stages $1\leq n\leq N$}\\
      \text{refinement $k=0$}
    }}
    + \underbrace{
      \strut
      K \cdot (t_F + t_G)
    }_{\substack{
      \vphantom{\text{stage}}
      n = N \\
      1 \leq k \leq K
    }}
    + t_F
  \end{equation*}
  \end{block}
  \only<1>{%
  \begin{figure}
    \includegraphics[width=0.7\textwidth]{figures/slides_timeline8.pdf}
    \caption{Timeline of $N=8$ stages computing $K=7$ refinements}
  \end{figure}}
  \only<2>{%
  \begin{table}
    \small
    \begin{tabular}{%
      lcc
      S[table-format=2.2]
      S[table-format=2.2]
      S[table-format=1.2]
      S[table-format=2.2]
      S[table-format=3.2]
      S[table-format=3.2]
      S[round-precision=3, round-minimum=0.001, table-format=<1.3, scientific-notation=fixed, fixed-exponent=0] % err
    }
      \toprule
      {warm-up} &
      {$N$} &
      {$K$} &
      {$\twarmup$} &
      {$\trampup$} &
      {$t_G$} &
      {$t_F$} &
      {$\tpar$} &
      {$\hattpar$} &
      {$\abs*{\frac{\hattpar-\tpar}{\tpar}}$} \\
      \midrule
      \input{tables/warmup8.tex}
      \bottomrule
    \end{tabular}
  \end{table}
  \begin{itemize}
    \item $t_F, t_G$: median runtime
    \item $\twarmup$: maximum runtime
    \item $\trampup$: mean delay between adjacent $G(U^0_*)$ minus $t_G$
  \end{itemize}
  }
\end{frame}
