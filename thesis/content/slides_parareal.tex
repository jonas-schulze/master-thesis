\subsection{Parareal Method}

\begin{frame}<1>{Parareal Method}
\begin{columns}
\column{0.7\textwidth}
  \begin{block}{General Formulation \parencite{Lions2001}}
    For the IVP $\dot u = f(u)$ the method reads
    \begin{equation*}
      \left\{
      \begin{aligned}
        U^0_{n+1} &:= G(U^0_n) \\
        U^{k+1}_{n+1} &:= G(U^{k+1}_n) + F(U^k_n) - G(U^k_n)
      \end{aligned}
      \right.
    \end{equation*}
    where $U_0^0 = u(t_0)$.
  \end{block}
  Low-rank formulation (KÃ¶hler, Saak, and Lang 2016):
  % GAMM Annual Meeting
  \begin{align*}
    U^{k+1}_{n+1}
    &= \underbrace{\colorldlt{\cola}}_{G(U^{k+1}_n)}
    + \underbrace{\colorldlt{\colb}}_{F(U^{k}_n)}
    - \underbrace{\colorldlt{\colc}}_{G(U^{k}_n)}
    \\
    &=
    \colorspacing % must be located in respective cell!
    \Bigg[
    \begin{matrix}
      \tallcmat{\cola} &
      \tallcmat{\colb} &
      \tallcmat{\colc}
    \end{matrix}
    \Bigg]
    \begin{bmatrix}
      \smallcmat{\cola} \\
      & \smallcmat{\colb} \\
      && -\smallcmat{\colc}
    \end{bmatrix}
    \begin{bmatrix}
      \widecmat{\cola} \\
      \widecmat{\colb} \\
      \widecmat{\colc}
    \end{bmatrix}
  \end{align*}
\column{0.3\textwidth}
\bigpicture{6}
\end{columns}
\end{frame}

%TODO: replace caption by parareal update formula?
\begin{frame}
  \setbeamertemplate{caption}[numbered]
  \frametitle{Parareal Example}
\begin{columns}
\column{0.65\textwidth}
  \begin{figure}
  \foreach \k in {0,1} {%
  \foreach \n [evaluate={\i=int(1+\n+\k*7)}] in {0,...,6} {%
    \includegraphics<\i>[width=\textwidth]{figures/parareal-anim/step-\k-\n.pdf}%
  }}%
  \includegraphics<15>[width=\textwidth]{figures/parareal-anim/step-2-5.pdf}%
  \includegraphics<16>[width=\textwidth]{figures/parareal-anim/step-2-6.pdf}%
  \includegraphics<17>[width=\textwidth]{figures/parareal-anim/step-3-5.pdf}%
  \includegraphics<18>[width=\textwidth]{figures/parareal-anim/step-3-6.pdf}%
  \renewcommand\thefigure{6.4} % number in thesis
  \caption{Parareal method applied to a linear ODE}
  \end{figure}
\column{0.35\textwidth}
  \input{figures/slide_parareal_anim.tex}
\end{columns}
\end{frame}

